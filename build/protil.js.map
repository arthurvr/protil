{"version":3,"sources":["../lib/protil.js"],"names":[],"mappings":";;;;;AAKA,CAAC,CAAA,UAAS,IAAI,EAAE,OAAO,EAAE;AACvB,MAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;AAC/B,QAAI,QAAO,GAAG,QAAO,IAAI,OAAO,CAAC,gBAAgB,CAAC,CAAC;AACnD,UAAM,CAAC,OAAO,GAAG,QAAO,CAAC;AACzB,UAAM,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;GAClC,MAAM,IAAI,IAAI,CAAC,MAAM,EAAE;AACtB,QAAI,CAAC,MAAM,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;GAC7B;CACF,CAAA,CAAC,IAAI,EAAE,UAAS,IAAI,EAAE;AACrB,cAAY,CAAC;;AAEb,MAAI,MAAM,GAAG,EAAE,CAAC;AAChB,MAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;;AAE3B,MAAI,IAAI,YAAA,CAAC;AACT,MAAI,IAAI,CAAC,MAAM,EAAE,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC;;AAEpC,QAAM,CAAC,UAAU,GAAG,YAAW;AAC7B,UAAM,CAAC,MAAM,GAAG,IAAI,CAAC;AACrB,WAAO,IAAI,CAAC;GACb,CAAC;;AAEF,QAAM,CAAC,WAAW,GAAG,UAAS,EAAE,EAAE;AAChC,QAAI,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,EAAE;AAC5B,YAAM,IAAI,KAAK,CAAC,sDAAsD,CAAC,CAAC;KACzE,MAAM;AACL,aAAO,GAAG,EAAE,CAAC;KACd;GACF,CAAC;;;;;;;;;;;;AAaF,QAAM,CAAC,cAAc,GAAG,UAAS,CAAC,EAAE;AAClC,WAAO,OAAO,CAAC,CAAC,IAAI,EAAE,CAAC,IAAI,KAAK,UAAU,IACxC,CAAC,CAAC,IAAI,EAAE,YAAY,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC;GAC5D,CAAC;;;;;;;;AAQF,QAAM,CAAC,cAAc,GAAG,UAAS,EAAE,EAAE;AACnC,QAAI,IAAI,GAAG,EAAE,IAAI,OAAO,CAAC;AACzB,QAAI,CAAC,YAAA,CAAC;;AAEN,QAAI;AACF,OAAC,GAAG,IAAI,IAAI,CAAC,UAAS,OAAO,EAAE,MAAM,EAAE;AACrC,eAAO,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;OAC7C,CAAC,CAAC;KACJ,CAAC,OAAO,CAAC,EAAE;AACV,aAAO,KAAK,CAAC;KACd;;AAED,WAAO,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;GAC/B,CAAC;;AAEF,SAAO,MAAM,CAAC;CACf,CAAC,CAAC","file":"protil.js","sourcesContent":["/**\n * protil\n * a utility library for working with promises\n */\n\n!function(root, factory) {\n  if (typeof exports === 'object') {\n    let Promise = Promise || require('../lib/Promise');\n    global.Promise = Promise;\n    module.exports = factory(global);\n  } else if (root.window) {\n    root.protil = factory(root);\n  }\n}(this, function(root) {\n  'use strict';\n\n  let protil = {};\n  let Promise = root.Promise;\n\n  let prev;\n  if (root.protil) prev = root.protil;\n\n  protil.noConflict = function() {\n    global.protil = prev;\n    return this;\n  };\n\n  protil.setPromises = function(Pc) {\n    if (!this._checkPromises(Pc)) {\n      throw new Error('protil Promises must provide ES6 Promise Constructor');\n    } else {\n      Promise = Pc;\n    }\n  };\n\n\n  //\n  //  Helpers\n  //\n\n  /**\n   * Check if promise follows A+ spec\n   * https://promisesaplus.com/\n   * @param p (promise)\n   * @returns {boolean}\n   */\n  protil.isValidPromise = function(p) {\n    return typeof p.then().then === 'function' &&\n      p.then() instanceof Object.getPrototypeOf(p).constructor;\n  };\n\n  /**\n   * Make sure Promise constructor is available\n   * @param Pc\n   * @returns {boolean}\n   * @private\n   */\n  protil._checkPromises = function(Pc) {\n    let Prom = Pc || Promise;\n    let p;\n\n    try {\n      p = new Prom(function(resolve, reject) {\n        return true ? resolve(true) : reject(false);\n      });\n    } catch (e) {\n      return false;\n    }\n\n    return this.isValidPromise(p);\n  };\n\n  return protil;\n});\n"]}